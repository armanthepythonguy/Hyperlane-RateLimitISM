"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isCheckpoint = exports.isS3CheckpointWithId = exports.isS3Checkpoint = void 0;
const ethers_1 = require("ethers");
function isValidSignature(signature) {
    return typeof signature === 'string'
        ? ethers_1.utils.isHexString(signature)
        : ethers_1.utils.isHexString(signature.r) &&
            ethers_1.utils.isHexString(signature.s) &&
            Number.isSafeInteger(signature.v);
}
function isS3Checkpoint(obj) {
    return isValidSignature(obj.signature) && isCheckpoint(obj.value);
}
exports.isS3Checkpoint = isS3Checkpoint;
function isS3CheckpointWithId(obj) {
    return (isValidSignature(obj.signature) &&
        isCheckpoint(obj.value.checkpoint) &&
        ethers_1.utils.isHexString(obj.value.message_id));
}
exports.isS3CheckpointWithId = isS3CheckpointWithId;
function isCheckpoint(obj) {
    const isValidRoot = ethers_1.utils.isHexString(obj.root);
    const isValidIndex = Number.isSafeInteger(obj.index);
    const isValidMailbox = ethers_1.utils.isHexString(obj.mailbox_address);
    const isValidDomain = Number.isSafeInteger(obj.mailbox_domain);
    return isValidIndex && isValidRoot && isValidMailbox && isValidDomain;
}
exports.isCheckpoint = isCheckpoint;
//# sourceMappingURL=checkpoints.js.map